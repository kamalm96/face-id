# Simple Face ID-like System

## Disclaimer: Only the README.md in this project was Generated by AI. This code is human-generated, No AI was used.

This project implements a simplified face detection and recognition system, similar in concept to Apple's Face ID (but without the security features or specialized hardware). It uses pre-trained deep learning models for accuracy and ease of use.

## How it Works

The system operates in two main phases:

1.  **Enrollment (`enroll_faces.py`)**:
    *   **Input**: A directory (`known_faces/`) containing subdirectories for each known person. Each subdirectory holds several images of that person's face.
    *   **Face Detection**: The [MTCNN (Multi-task Cascaded Convolutional Networks)](https://arxiv.org/abs/1604.02878) model is used to detect faces in the provided images and crop them.
    *   **Face Embedding**: For each detected face, a [FaceNet-like (InceptionResnetV1)](https://arxiv.org/abs/1503.03832) model (pre-trained on the VGGFace2 dataset) generates a high-dimensional numerical vector called an "embedding." This embedding uniquely represents the facial features.
    *   **Averaging & Storage**: The embeddings for all images of a single person are averaged to create a more robust representative embedding for that person. These named average embeddings are then saved to a file (`known_embeddings.pt`).

2.  **Recognition (`recognize_face.py`)**:
    *   **Load Embeddings**: The system first loads the `known_embeddings.pt` file.
    *   **Input**: A new image (either from a file path or live from a webcam).
    *   **Face Detection**: MTCNN detects faces in the input image.
    *   **Face Embedding**: For each detected face, the InceptionResnetV1 model generates its embedding.
    *   **Comparison**: The embedding of the new face is compared against all known embeddings loaded earlier. [Cosine Similarity](https://en.wikipedia.org/wiki/Cosine_similarity) is used as the metric.
        *   Cosine similarity measures the cosine of the angle between two vectors, giving a value between -1 and 1 (or 0 and 1 for non-negative vectors). A value closer to 1 indicates higher similarity.
    *   **Identification**: If the highest similarity score for a new face with any known person exceeds a predefined `SIMILARITY_THRESHOLD` (e.g., 0.70), the face is identified as that person. Otherwise, it's labeled "Unknown."
    *   **Output**: The input image/video stream is displayed with bounding boxes around detected faces and their identified names (or "Unknown") along with the similarity score.

## Setup and Installation

1.  **Prerequisites**:
    *   Python 3.7+
    *   `pip` (Python package installer)

2.  **Create Project Directory**:
    ```bash
    mkdir face_id_project
    cd face_id_project
    ```

3.  **Virtual Environment (Recommended)**:
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

4.  **Install Dependencies**:
    Create a `requirements.txt` file in the `face_id_project` directory with the following content:
    ```txt
    torch
    torchvision
    facenet-pytorch
    opencv-python
    numpy
    Pillow
    ```
    Then run:
    ```bash
    pip install -r requirements.txt
    ```
    *Note: `torch` and `torchvision` can be large. If you have an NVIDIA GPU and want CUDA support, visit the [PyTorch website](https://pytorch.org/get-started/locally/) for specific installation commands.*

5.  **Prepare Enrollment Photos**:
    *   Create a directory named `known_faces` inside `face_id_project`.
    *   Inside `known_faces`, create a subdirectory for each person you want to enroll (e.g., `YourName`, `WifeName`).
    *   Place 5-10 clear photos of each person's face into their respective subdirectories. Use JPEG or PNG formats. Variety in lighting and expression is good, but ensure the face is the primary subject.

    Example structure:
    ```
    face_id_project/
    ├── known_faces/
    │   ├── YourName/
    │   │   ├── 1.jpg
    │   │   └── 2.jpg
    │   └── WifeName/
    │       ├── 1.jpg
    │       └── 2.jpg
    ├── enroll_faces.py
    ├── recognize_face.py
    ├── requirements.txt
    └── README.md
    ```

## How to Use

1.  **Enroll Faces**:
    Run the enrollment script from the `face_id_project` directory:
    ```bash
    python enroll_faces.py
    ```
    This will process the images in the `known_faces` directory and create a `known_embeddings.pt` file. You only need to do this once, or whenever you add new people or new photos of existing people.

2.  **Recognize Faces**:

    *   **From an image file**:
        ```bash
        python recognize_face.py --image_path /path/to/your/test_image.jpg
        ```
        Replace `/path/to/your/test_image.jpg` with the actual path to an image you want to test. An image window will pop up. Press 'q' to close it.

    *   **From webcam**:
        ```bash
        python recognize_face.py
        ```
        (Or `python recognize_face.py --image_path 0`)
        This will open your webcam feed. Detected faces will be boxed and labeled. Press 'q' while the webcam window is active to quit.

## Testing with Your Photos

1.  **Enrollment**:
    *   Make sure you have created `face_id_project/known_faces/YourName/` and `face_id_project/known_faces/WifeName/`.
    *   Add 5-10 distinct photos of yourself into your folder, and 5-10 photos of your wife into her folder.
    *   Run `python enroll_faces.py`. Check the console output to ensure both you and your wife are processed and embeddings are saved.

2.  **Recognition - Test Image**:
    *   Find a new photo of yourself (not used in enrollment) and one of your wife.
    *   Test with your photo: `python recognize_face.py --image_path /path/to/your_new_photo.jpg`
    *   Test with your wife's photo: `python recognize_face.py --image_path /path/to/wife_new_photo.jpg`
    *   Test with a photo containing both of you, or a photo of an unknown person.

3.  **Recognition - Webcam**:
    *   Run `python recognize_face.py`.
    *   Position yourself in front of the webcam. Check if you are correctly identified.
    *   Ask your wife to position herself. Check her identification.
    *   Try different distances, lighting conditions (within reason), and expressions.

## Customization and Considerations

*   **`SIMILARITY_THRESHOLD`**: In `recognize_face.py`, you can adjust `SIMILARITY_THRESHOLD` (default 0.70).
    *   Higher value: More strict, fewer false positives (identifying an unknown as known), but might miss correct identifications (false negatives).
    *   Lower value: Less strict, more likely to identify correctly, but higher chance of false positives.
*   **Enrollment Photos**: The quality and variety of enrollment photos significantly impact recognition accuracy. More photos with diverse (but clear) facial presentations generally lead to better results.
*   **Performance**: Face detection and embedding generation can be computationally intensive. Using a GPU (`DEVICE = torch.device('cuda')`) will significantly speed up the process if you have a compatible NVIDIA GPU and CUDA installed.
*   **WIDER Dataset**: While the WIDER Face dataset is excellent for *training face detection models from scratch*, this project leverages pre-trained models for convenience and performance. The MTCNN model used here was likely trained on datasets like WIDER, CelebA, or similar large-scale face datasets.
*   **Security**: This project is **not secure** and should not be used for actual security applications. It's an educational tool to understand the basics of face recognition pipelines. Real Face ID systems use specialized hardware (like 3D depth sensors) and sophisticated anti-spoofing techniques.

## Limitations

*   Sensitive to severe occlusions (e.g., masks, sunglasses), extreme poses, and very poor lighting.
*   Performance depends heavily on the quality of the pre-trained models.
*   No anti-spoofing (can be fooled by a photo).
*   Accuracy might vary significantly based on individual facial features and the diversity of the enrolled images.#   f a c e - i d  
 